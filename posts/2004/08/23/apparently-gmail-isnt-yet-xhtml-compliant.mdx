---
title: "Apparently, GMail isn't yet XHTML-compliant  #Life"
sort: 2008
---
<p>For a while now, I've been subscribed to get e-mails whenever someone posts something to the <a href="http://www.gotdotnet.com/Community/MessageBoard/MessageBoard.aspx?id=234">FxCop forum</a>. (How primitive. I'm still waiting for them to get their act together and start providing RSS feeds like a civilized Web site.)</p>
<p>As soon as I <a href="http://blog.excastle.com/2004/08/03/whee/">got my GMail account</a>, I started sending the forum notifications there. And let me tell you, GMail's threading features are <em>nice</em> for reading mailing-list e-mails. It automatically groups all the messages with the same subject, and lets you read an entire thread at once, on a single screen. Very slick.</p>
<p>The only problem is, GMail strips out all the line breaks. So the entire message gets rendered as a single paragraph, with no formatting at all. Ouch. Reading source-code samples is downright painful. Reading <em>text</em> is downright painful, if there are more than a few paragraphs and they're not split up in a sane way. At first I figured everyone was just a silly newbie, but once it started happening to posts from people I had read before, it dawned on me that something wasn't right.</p>
<p>So this morning I decided to figure out why. GMail lets me view the full headers and source of the original message, so I did. Looked fairly normal; there was a text version and an HTML version, in multipart/alternative format, which everyone should speak. Both the plain-text and the HTML versions had line breaks (or line-break tags) where they ought to be. Back in the GMail window, it was obvious they were showing the HTML version, because there were placeholders for the GotDotNet image banner at the top.</p>
<p>Okay, do a View Source on the GMail window.</p>
<p>Heh. Or not. All I see is a message saying "Javascript is disabled in your browser", together with a few JavaScript calls, all mashed together on one line. Makes it hard to see how GMail rendered my message, doesn't it?</p>
<p><a href="http://update.mozilla.org/extensions/moreinfo.php?application=firefox&amp;id=31">Powernarwhal</a> to the rescue. FireFox lets you select text, and then view the source for just that selection, and it works even for HTML that was rendered by JavaScript. Cool.</p>
<p>So here's the deal: The message arrived with some &lt;table&gt; tags, and those came through intact, as did their relatives &lt;tr&gt;, &lt;td&gt;, etc. The &lt;img&gt; tags were tweaked, of course, to hide the images; but they also came through. &lt;span&gt;? No problem.</p>
<p>The message included some other, mysterious tags &#8212; the &lt;ThreadTitle&gt; tag, for example. I'm not quite sure why they put that one in, since nobody's going to have a clue what to do with it. GMail apparently wondered the same thing, because they stripped it out. The text inside it came through; the tag itself did not. Interesting.</p>
<p>That's not the only tag they stripped out, either. The &lt;br/&gt; tags were gone as well. (Sure explains the missing line breaks in a hurry, doesn't it?)</p>
<p>I suspect (though I haven't checked) that &lt;br&gt; tags (without the "/") <em>do</em> come through okay, and that there's a bug in their regex. Duly reported via their feedback system. It's really weird that they would lose XHTML-compliant tags, because they apparently convert all the tags to XHTML casing (all-lowercase) as part of their rendering &#8212; &lt;Span&gt; in the e-mail is rendered as &lt;span&gt; by GMail. Unlike, say, my blog's GUI editor, which insists on making all the tag names all-caps (ouch).</p>
